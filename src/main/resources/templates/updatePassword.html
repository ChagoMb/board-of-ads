<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/xhtml"
>
<body>
<div><!--sec:authorize="hasAuthority('CHANGE__PASSWORD__PRIVILEGE')"-->
    <h1 th:text="#{reset_password.message.reset_your_password}">reset</h1>
    <form action="/reset/savePassword" method="post">
        <input name="token" th:value="${token}" type="hidden">
        <label th:text="#{reset_password.label.user.password}">password</label>
        <input name="password" type="password" value="" required/>

        <label th:text="#{reset_password.label.user.confirmPass}">confirm</label>
        <input name="passwordConfirm" type="password" value="" required/>

        <div id="globalError" style="display:none"
             th:text="#{reset_password.message.password_matches}">error
        </div>
        <button id="btn" th:text="#{reset_password.message.update_password}" type="submit">submit</button>
    </form>

    <script>
        $("#btn").click(function () {
            alert("Пароли обновлены")
        });
        //let serverContext =[[@{/}]];
        /*  $(document).ready(function () {
              $('form').submit(function(event) {
                  savePass(event);
              });

              $(":password").keyup(function(){
                  if($("#password").val() != $("#matchPassword").val()){
                      $("#globalError").show().html([[#{reset_password.message.password_matches}]]);
       }else{
          $("#globalError").html("").hide();
                  }
              });
          });

       /*function savePass(event){
  event.preventDefault();
  if($("#password").val() != $("#matchPassword").val()){
      $("#globalError").show().html(/** [[#{reset_password.message.password_matches}]]** /);
      return;
  }
  var formData= $('form').serialize();
  $.post(serverContext + "user/savePassword",formData ,function(data){
      window.location.href = serverContext + "login?message="+data.message;
  })
  .fail(function(data) {
      if(data.responseJSON.error.indexOf("InternalError") > -1){
          window.location.href = serverContext + "login?message=" + data.responseJSON.message;
      }
      else{
          var errors = $.parseJSON(data.responseJSON.message);
          $.each( errors, function( index,item ){
              $("#globalError").show().html(item.defaultMessage);
          });
          errors = $.parseJSON(data.responseJSON.error);
          $.each( errors, function( index,item ){
              $("#globalError").show().append(item.defaultMessage+"<br/>");
          });
      }
  });
}*/
    </script>
</div>
</body>
</html>
